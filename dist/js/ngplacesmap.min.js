!function(){"use strict";var a=function(a,b,c){try{var d=a.geometry.location.A,e=a.geometry.location.F;return new google.maps.LatLng(d,e)}catch(f){return new google.maps.LatLng(b.lat,b.lng)}};angular.module("ngPlacesMap",[]).filter("gps",function(){return function(a,b){var c;try{c=JSON.parse(a)}catch(d){c=!1}return c&&c[b]?c[b]:""}}).directive("placesMap",function(){return{restrict:"E",replace:!0,scope:{customCallback:"&?",picked:"=?",address:"=?",fallback:"=?",mapType:"@?",readonly:"@?",responsive:"@?",draggable:"@?",toggleMapDraggable:"=?",placeNotFound:"=?",updateMarkerLabel:"=?",redrawMap:"=?",mapOptions:"=?",static:"@"},controller:["$scope",function(a){}],template:'<div class="dp-places-map-wrapper"><input type="text" class="dp-places-map-input"><div class="dp-places-map-canvas"></div></div>',link:function(b,c,d,e){var f="true"==b.draggable;b.toggleMapDraggable=function(a){f=a,m.setOptions({draggable:f,scrollwheel:f})},b.updateMarkerLabel=function(a){q.setContent(a)},b.redrawMap&&(b.redrawMap.updateMap=function(a){var b=new google.maps.LatLng(a.lat,a.lng);t(b,!1,!1),m.setCenter(b)});var g;g=b.static&&"true"==b.static?{zoom:5,draggable:!1,panControl:!1,zoomControl:!1,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,clickableIcons:!1}:{zoom:5};var h=angular.extend(g,b.mapOptions),i={};b.address&&(i=b.address,h.zoom=b.address.zoom||15);var j={};j.lat=41.87194,j.lng=12.567379999999957,b.fallback&&(j=b.fallback,h.zoom=b.fallback.zoom||h.zoom),b.draggable&&"false"==b.draggable&&(h.draggable=!1,h.scrollwheel=!1),b.mapType&&google.maps.MapTypeId[b.mapType]&&(h.mapTypeId=google.maps.MapTypeId[b.mapType]),h.center=a(i,j);var k=c.find("div")[0],l=c.find("input")[0];b.responsive&&"true"==b.responsive&&(k.className+=" responsive");var m=new google.maps.Map(k,h),n=new google.maps.places.PlacesService(m),o=new google.maps.Geocoder,p=new google.maps.Marker({map:m,anchorPoint:new google.maps.Point(0,-29)}),q=new google.maps.InfoWindow;b.readonly?l.style.display="none":m.controls[google.maps.ControlPosition.TOP_LEFT].push(l);var r=new google.maps.places.Autocomplete(l);r.bindTo("bounds",m);var s=function(a,c,d){if(!a.geometry)return void("function"==typeof b.placeNotFound?b.placeNotFound():alert("Pick a valid location"));a.geometry.viewport?m.fitBounds(a.geometry.viewport):(m.setCenter(a.geometry.location),m.setZoom(b.address&&b.address.zoom?b.address.zoom:15)),p.setIcon({url:a.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)});var e="",f="";c?(f=c,a.geometry.address=i,a.formatted_address=i):(a.address_components&&(e=[a.address_components[0]&&a.address_components[0].short_name||"",a.address_components[1]&&a.address_components[1].short_name||"",a.address_components[2]&&a.address_components[2].short_name||""].join(" ")),""!==e&&(f="<div><strong>"+a.name+"</strong><br>"+e+"</div>")),u(a.geometry.location,f,a,d)},t=function(a,b,c){var d=new google.maps.LatLng(a.lat(),a.lng());q.close();var e={};e.place_id=null,e.geometry={},e.geometry.location={A:a.lat(),F:a.lng()};var f="";b?(f=b,e.geometry.address=i,e.formatted_address=i,u(a,f,e,c)):o.geocode({location:d},function(b,d){var g="";d===google.maps.GeocoderStatus.OK&&b[0]&&b[0].address_components&&(g=[b[0].address_components[0]&&b[0].address_components[0].short_name||"",b[0].address_components[1]&&b[0].address_components[1].short_name||"",b[0].address_components[2]&&b[0].address_components[2].short_name||""].join(" ")),""!==g?f="<div><strong>"+g+"</strong></div>":g=a.lat()+", "+a.lng(),e.geometry.address=g,e.formatted_address=g,p.setPosition(a),p.setVisible(!0),u(a,f,e,c)})},u=function(a,c,d,e){q.close(),p.setVisible(!1),""!==c&&(q.setContent(c),q.open(m,p)),p.setPosition(a),p.setVisible(!0),b.picked=d,d.geometry.location.lat&&"function"==typeof d.geometry.location.lat||(d.geometry.location.lat=function(){return d.geometry.location.A}),d.geometry.location.lng&&"function"==typeof d.geometry.location.lng||(d.geometry.location.lng=function(){return d.geometry.location.F}),e&&b.customCallback({pickedPlace:d}),b.$apply()},v=function(){q.close(),p.setVisible(!1);var a=r.getPlace();s(a,null,!0)};if(i.place_id)n.getDetails({placeId:i.place_id},function(a,b){b===google.maps.places.PlacesServiceStatus.OK&&s(a,i.address,!1)});else if(i.hasOwnProperty("geometry")){var w=new google.maps.LatLng(i.geometry.location.A,i.geometry.location.F);o.geocode({location:w},function(a,b){b===google.maps.GeocoderStatus.OK&&t(a[0].geometry.location,i.address,!1)})}google.maps.event.addListener(r,"place_changed",v),google.maps.event.addDomListener(window,"resize",function(){var a=m.getCenter();google.maps.event.trigger(m,"resize"),m.setCenter(a)}),google.maps.event.addListener(m,"click",function(a){f&&t(a.latLng,null,!0)})}}})}();