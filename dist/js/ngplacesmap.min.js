!function(){"use strict";var a=function(a,b,c){try{var d=a.geometry.location.A,e=a.geometry.location.F;return new google.maps.LatLng(d,e)}catch(f){return new google.maps.LatLng(b.lat,b.lng)}};angular.module("ngPlacesMap",[]).filter("gps",function(){return function(a,b){var c;try{c=JSON.parse(a)}catch(d){c=!1}return c&&c[b]?c[b]:""}}).directive("placesMap",function(){return{restrict:"E",replace:!0,scope:{customCallback:"&?",picked:"=?",address:"=?",fallback:"=?",mapType:"@?",readonly:"@?",responsive:"@?",draggable:"@?",toggleMapDraggable:"=?",placeNotFound:"=?",updateMarkerLabel:"=?"},controller:["$scope",function(a){}],template:'<div class="dp-places-map-wrapper"><input type="text" class="dp-places-map-input"><div class="dp-places-map-canvas"></div></div>',link:function(b,c,d,e){var f="true"==b.draggable;b.toggleMapDraggable=function(a){f=a,l.setOptions({draggable:f,scrollwheel:f})},b.updateMarkerLabel=function(a){p.setContent(a)};var g={zoom:5},h={};b.address&&(h=b.address,g.zoom=b.address.zoom||15);var i={};i.lat=41.87194,i.lng=12.567379999999957,b.fallback&&(i=b.fallback,g.zoom=b.fallback.zoom||5),b.draggable&&"false"==b.draggable&&(g.draggable=!1,g.scrollwheel=!1),b.mapType&&google.maps.MapTypeId[b.mapType]&&(g.mapTypeId=google.maps.MapTypeId[b.mapType]),g.center=a(h,i);var j=c.find("div")[0],k=c.find("input")[0];b.responsive&&"true"==b.responsive&&(j.className+=" responsive");var l=new google.maps.Map(j,g),m=new google.maps.places.PlacesService(l),n=new google.maps.Geocoder,o=new google.maps.Marker({map:l,anchorPoint:new google.maps.Point(0,-29)}),p=new google.maps.InfoWindow;b.readonly?k.style.display="none":l.controls[google.maps.ControlPosition.TOP_LEFT].push(k);var q=new google.maps.places.Autocomplete(k);q.bindTo("bounds",l);var r=function(a,c,d){if(!a.geometry)return void("function"==typeof b.placeNotFound?b.placeNotFound():alert("Pick a valid location"));a.geometry.viewport?l.fitBounds(a.geometry.viewport):(l.setCenter(a.geometry.location),l.setZoom(b.address&&b.address.zoom?b.address.zoom:15)),o.setIcon({url:a.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)});var e="",f="";c?(f=c,a.geometry.address=h,a.formatted_address=h):(a.address_components&&(e=[a.address_components[0]&&a.address_components[0].short_name||"",a.address_components[1]&&a.address_components[1].short_name||"",a.address_components[2]&&a.address_components[2].short_name||""].join(" ")),""!==e&&(f="<div><strong>"+a.name+"</strong><br>"+e+"</div>")),t(a.geometry.location,f,a,d)},s=function(a,b,c){var d=new google.maps.LatLng(a.A,a.F);p.close();var e={};e.place_id=null,e.geometry={},e.geometry.location={A:a.A,F:a.F};var f="";b?(f=b,e.geometry.address=h,e.formatted_address=h,t(a,f,e,c)):n.geocode({location:d},function(b,d){var g="";d===google.maps.GeocoderStatus.OK&&b[0]&&b[0].address_components&&(g=[b[0].address_components[0]&&b[0].address_components[0].short_name||"",b[0].address_components[1]&&b[0].address_components[1].short_name||"",b[0].address_components[2]&&b[0].address_components[2].short_name||""].join(" ")),""!==g?f="<div><strong>"+g+"</strong></div>":g=a.A+", "+a.F,e.geometry.address=g,e.formatted_address=g,o.setPosition(a),o.setVisible(!0),t(a,f,e,c)})},t=function(a,c,d,e){p.close(),o.setVisible(!1),""!==c&&(p.setContent(c),p.open(l,o)),o.setPosition(a),o.setVisible(!0),b.picked=d,e&&b.customCallback({pickedPlace:d}),b.$apply()},u=function(){p.close(),o.setVisible(!1);var a=q.getPlace();r(a,null,!0)};if(h.place_id)m.getDetails({placeId:h.place_id},function(a,b){b===google.maps.places.PlacesServiceStatus.OK&&r(a,h.address,!1)});else if(h.hasOwnProperty("geometry")){var v=new google.maps.LatLng(h.geometry.location.A,h.geometry.location.F);n.geocode({location:v},function(a,b){b===google.maps.GeocoderStatus.OK&&s(a[0].geometry.location,h.address,!1)})}google.maps.event.addListener(q,"place_changed",u),google.maps.event.addDomListener(window,"resize",function(){var a=l.getCenter();google.maps.event.trigger(l,"resize"),l.setCenter(a)}),google.maps.event.addListener(l,"click",function(a){f&&s(a.latLng,null,!0)})}}})}();